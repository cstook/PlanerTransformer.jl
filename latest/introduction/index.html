<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · PlanerTransformer</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PlanerTransformer</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../install/">Installation</a></li><li class="current"><a class="toctext" href>Introduction</a><ul class="internal"><li><a class="toctext" href="#Transformer-with-Double-Sided-PCB-1">Transformer with Double Sided PCB</a></li><li><a class="toctext" href="#Double-and-Interleave-the-Windings-1">Double and Interleave the Windings</a></li><li><a class="toctext" href="#Copper-Strip-Secondary-1">Copper Strip Secondary</a></li><li><a class="toctext" href="#Primary-in-Series-1">Primary in Series</a></li><li><a class="toctext" href="#LTspice-Model-1">LTspice Model</a></li></ul></li><li><a class="toctext" href="../design_api/">Design API</a></li><li><a class="toctext" href="../data_entry_api/">Data Entry API</a></li><li><a class="toctext" href="../internal_api/">Internal API</a></li><li><a class="toctext" href="../APIindex/">API index</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Introduction</a></li></ul><a class="edit-page" href="https://github.com/cstook/PlanerTransformer.jl/tree/ba29159f63879517ba6a15a6bc4e458c6e05d51a/docs/src/introduction.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Introduction</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Introduction-1" href="#Introduction-1">Introduction</a></h1><p>This module is based on the design procedure described in <a href="http://www.ti.com/download/trng/docs/seminar/Topic4LD.pdf">Designing Planar Magnetics</a>. The paper uses a 500kHz forward converter with 48V input and 2.5V output as an example of the design procedure.  This introduction will use the same example to introduce the <code>PlanerTransformer</code> API.</p><p>Load the module.</p><div><pre><code class="language-julia">using PlanerTransformer</code></pre></div><p>Define the operating frequency and maximum specific power loss for the transformer</p><div><pre><code class="language-julia">frequency = 0.5e6 # Hz
spl_max = 150e3 # W/m^3</code></pre></div><p>Standard core geometries are available in <code>core_geometry_dict</code>.   An ER25 core / plate set will be used.</p><div><pre><code class="language-julia">core = core_geometry_dict[&quot;er25/5.5_plt&quot;]</code></pre></div><p>The properities of some ferrites are available in <code>ferrite_dict</code>.</p><div><pre><code class="language-julia">ferrite = ferrite_dict[&quot;3f35&quot;]</code></pre></div><p>The functions <code>specific_power_loss</code> and <code>flux_density</code> interpolate the specific power loss curves from the data sheet.</p><p><code>flux_density</code> returns the maximum flux density for given specific power loss for two ferrites.</p><div><pre><code class="language-julia">flux_density_max_pp = flux_density(ferrite, spl_max, frequency) * 2.0 # Tesla</code></pre><pre><code class="language-none">0.12082069532040642</code></pre></div><p>Calculate volt seconds per turn.</p><div><pre><code class="language-julia">vspt = volt_seconds_per_turn(core, flux_density_max_pp)</code></pre><pre><code class="language-none">1.0837616370240456e-5</code></pre></div><p>Maximum output voltage for forward converter with 1T secondary.</p><div><pre><code class="language-julia">duty = 0.5 # 50% maximum duty cycle
t_on = duty/frequency
v_peak_at_transformer_1t = vspt/t_on # always work with peak I,V at transformer
v_out_forward_converter = v_peak_at_transformer_1t * duty #  vspt * frequency</code></pre><pre><code class="language-none">5.418808185120228</code></pre></div><h2><a class="nav-anchor" id="Transformer-with-Double-Sided-PCB-1" href="#Transformer-with-Double-Sided-PCB-1">Transformer with Double Sided PCB</a></h2><p>Start by defining the  PCB with <code>PCB_Specification</code>.  This transformer will be built with a double sided PCB with 4oz copper.</p><div><pre><code class="language-julia">trace_edge_gap = 0.5e-3
trace_trace_gap = 0.4e-3
copper_thickness = copper_weight_to_meters(4.0) # 4.0oz copper
dielectric_thickness = 0.125e-3
stackup = Stackup((copper,           fr408,                copper),
                  (copper_thickness, dielectric_thickness, copper_thickness))
pcb = PCB_Specification(trace_edge_gap,
                        trace_trace_gap,
                        stackup)</code></pre></div><p>Specify the <code>windings</code>.  <code>PlanerTransformer</code> only allows transformers with two windings. All primary layers must have the same number of turns.  All secondary layers must have the same number of turns.  Primary and secondary layers may be in series or parallel.  For this transformer, the primary is a single layer with 6 turns. The secondary is a single layer with 1 turn.</p><div><pre><code class="language-julia">primary_turns_per_layer = 6
secondary_turns_per_layer = 1
is_layer_primary = (true, false) # which layers belong to primary and secondary
are_primary_layers_in_series = false
are_secondary_layers_in_series = false
my_windings = windings(pcb, core,
                       primary_turns_per_layer,
                       secondary_turns_per_layer,
                       is_layer_primary,
                       are_primary_layers_in_series,
                       are_secondary_layers_in_series)</code></pre></div><p><code>volt_seconds</code> returns a tuple of the maximum volt seconds on (primary, secondary) to stay within the core flux density peak-peak.</p><p>Maximum voltage at the input output of the converter.</p><div><pre><code class="language-julia">max_volts_transformer_peak = volt_seconds(my_windings,flux_density_max_pp)./t_on
(input, output) = (max_volts_transformer_peak[1], max_volts_transformer_peak[2]*duty)</code></pre><pre><code class="language-none">(65.02569822144274, 5.418808185120228)</code></pre></div><p>Create a transformer by combining a ferrite with windings.</p><div><pre><code class="language-julia">transformer_3f35_2layer = Transformer(ferrite, my_windings)</code></pre></div><p>Verify 6:1 turns ratio.</p><div><pre><code class="language-julia">turns(transformer_3f35_2layer) # (primary, secondary)</code></pre><pre><code class="language-none">(6, 1)</code></pre></div><p>Leakage inductance is referenced to primary.</p><div><pre><code class="language-julia">leakage_inductance(transformer_3f35_2layer)</code></pre><pre><code class="language-none">5.3295863765882534e-8</code></pre></div><p>To calculate power dissipation, the operating conditions must be specified.</p><p>Define parameters for the switching power supply using the transformer.  Power must flow from primary to secondary (v_in positive, i_out negative).</p><div><pre><code class="language-julia">v_in = 48.0
i_out = -7.0
duty = 0.50
my_converter = Forward(v_in, i_out, frequency, duty) # or PushPull</code></pre></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Within <code>PlanerTrnasformer</code> Voltages and currents are peak at the transformer, and powers are averages. They are not the DC input and output of the switching power supply.</p></div></div><p>Calculate power dissipation, and other stuff,  of a transformer in a  switching power supply.</p><div><pre><code class="language-julia">tpa = transformer_power_analysis(transformer_3f35_2layer, my_converter)</code></pre></div><p>Many parameters can be displayed</p><div><pre><code class="language-julia">voltage(tpa) # (primary, secondary)</code></pre><pre><code class="language-none">(48.0, 7.958610400333346)</code></pre></div><div><pre><code class="language-julia">current(tpa) # (primary, secondary)</code></pre><pre><code class="language-none">(1.172742353309693, -7.0)</code></pre></div><div><pre><code class="language-julia">input_power(tpa)</code></pre><pre><code class="language-none">28.145816479432632</code></pre></div><div><pre><code class="language-julia">output_power(tpa)</code></pre><pre><code class="language-none">-27.85513640116671</code></pre></div><div><pre><code class="language-julia">ac_winding_resistance(tpa) # (primary, secondary)</code></pre><pre><code class="language-none">(0.15551740755970406, 0.0023999599932053098)</code></pre></div><div><pre><code class="language-julia">dc_winding_resistance(tpa) # (primary, secondary)</code></pre><pre><code class="language-none">(0.11724759154496064, 0.0018093764127308746)</code></pre></div><div><pre><code class="language-julia">equilivent_resistance(tpa) # (primary, secondary)</code></pre><pre><code class="language-none">(0.13638249955233234, 0.002104668202968092)</code></pre></div><div><pre><code class="language-julia">core_specific_power(tpa) # W/m^3</code></pre><pre><code class="language-none">61320.92916174595</code></pre></div><div><pre><code class="language-julia">core_total_power(tpa)</code></pre><pre><code class="language-none">0.14533060211333793</code></pre></div><div><pre><code class="language-julia">winding_power(tpa) # (primary, secondary)</code></pre><pre><code class="language-none">(0.09378510517986895, 0.05156437097271826)</code></pre></div><div><pre><code class="language-julia">total_power(tpa)</code></pre><pre><code class="language-none">0.2906800782659251</code></pre></div><p>Total power dissipation with 20A output</p><div><pre><code class="language-julia">converter_20 =  Forward(v_in,-20.0,frequency,duty) # same as above, except 20A
total_power(transformer_power_analysis(transformer_3f35_2layer, converter_20))</code></pre><pre><code class="language-none">1.3240760183331381</code></pre></div><p>The next three sections Double and Interleave the Windings, Copper Strip Secondary, and Primary in Series are a series of improvements on this transformer.</p><h2><a class="nav-anchor" id="Double-and-Interleave-the-Windings-1" href="#Double-and-Interleave-the-Windings-1">Double and Interleave the Windings</a></h2><div><pre><code class="language-julia">b_stage_thickness = 0.0762
double_stackup = Stackup((copper,           fr408,                copper,           fr408,             copper,
                         fr408,                copper),
                         (copper_thickness, dielectric_thickness, copper_thickness, b_stage_thickness, copper_thickness, dielectric_thickness, copper_thickness))
double_pcb = PCB_Specification(trace_edge_gap,
                               trace_trace_gap,
                               double_stackup)
double_windings = windings(double_pcb, core,
                           primary_turns_per_layer,
                           secondary_turns_per_layer,
                           prisec&quot;S-P-P-S&quot;, # use prisec string to specify which layers are primary and secondary.
                           are_primary_layers_in_series,
                           are_secondary_layers_in_series)

double_transformer_3f35 = Transformer(ferrite_dict[&quot;3f35&quot;], double_windings)
double_tpa = transformer_power_analysis(double_transformer_3f35, my_converter)
total_power(transformer_power_analysis(double_transformer_3f35, converter_20))</code></pre><pre><code class="language-none">0.7354169778892867</code></pre></div><h2><a class="nav-anchor" id="Copper-Strip-Secondary-1" href="#Copper-Strip-Secondary-1">Copper Strip Secondary</a></h2><div><pre><code class="language-julia">strip_stackup = Stackup((copper,                 fr408,                copper,           fr408,             copper,
                         fr408,                copper),
                         (copper_thickness+1e-3, dielectric_thickness, copper_thickness, b_stage_thickness, copper_thickness, dielectric_thickness, copper_thickness+1e-3))
strip_pcb = PCB_Specification(trace_edge_gap,
                              trace_trace_gap,
                              strip_stackup)
strip_windings = windings(strip_pcb, core,
                          primary_turns_per_layer,
                          secondary_turns_per_layer,
                          prisec&quot;S-P-P-S&quot;,
                          are_primary_layers_in_series,
                          are_secondary_layers_in_series)

strip_transformer_3f35 = Transformer(ferrite_dict[&quot;3f35&quot;], strip_windings)
strip_tpa = transformer_power_analysis(strip_transformer_3f35, my_converter)
total_power(transformer_power_analysis(strip_transformer_3f35, converter_20))</code></pre><pre><code class="language-none">0.6560583632958275</code></pre></div><h2><a class="nav-anchor" id="Primary-in-Series-1" href="#Primary-in-Series-1">Primary in Series</a></h2><div><pre><code class="language-julia">series_windings = windings(strip_pcb, core,
                          3, # turns per layer, primary
                          secondary_turns_per_layer,
                          prisec&quot;S-P-P-S&quot;,
                          true, # primary layers are in series
                          are_secondary_layers_in_series)

series_transformer_3f35 = Transformer(ferrite_dict[&quot;3f35&quot;], series_windings)
series_tpa = transformer_power_analysis(series_transformer_3f35, my_converter)
total_power(transformer_power_analysis(series_transformer_3f35, converter_20))</code></pre><pre><code class="language-none">0.5333999895738089</code></pre></div><h2><a class="nav-anchor" id="LTspice-Model-1" href="#LTspice-Model-1">LTspice Model</a></h2><p>Parameters for a circuit simulation can be extracted.</p><div><pre><code class="language-julia">(n1, n2) = turns(series_transformer_3f35)</code></pre><pre><code class="language-none">(6, 1)</code></pre></div><div><pre><code class="language-julia">l2 = leakage_inductance(series_transformer_3f35)</code></pre><pre><code class="language-none">2.6647931882941267e-8</code></pre></div><div><pre><code class="language-julia">l1 = chan_inductor(series_transformer_3f35)</code></pre><pre><code class="language-none">Hc=25.0, Bs=0.4, Br=0.15, A=8.97e-5, Lm=0.0264, Lg=0.0, N=1.0</code></pre></div><div><pre><code class="language-julia">(r1, r2) = equilivent_resistance(series_tpa)</code></pre><pre><code class="language-none">(0.04607516876767984, 0.000655541028516749)</code></pre></div><div><pre><code class="language-julia">r3 = r_core(series_tpa)</code></pre><pre><code class="language-none">218.28082829951273</code></pre></div><p><img src="../LTspice transformer model.jpg" alt="LTspice transformer model"/></p><footer><hr/><a class="previous" href="../install/"><span class="direction">Previous</span><span class="title">Installation</span></a><a class="next" href="../design_api/"><span class="direction">Next</span><span class="title">Design API</span></a></footer></article></body></html>
