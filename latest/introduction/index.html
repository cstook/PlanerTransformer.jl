<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · PlanerTransformer</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PlanerTransformer</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../install/">Installation</a></li><li class="current"><a class="toctext" href>Introduction</a><ul class="internal"></ul></li><li><a class="toctext" href="../design_api/">Design API</a></li><li><a class="toctext" href="../data_entry_api/">Data Entry API</a></li><li><a class="toctext" href="../APIindex/">API index</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Introduction</a></li></ul><a class="edit-page" href="https://github.com/cstook/PlanerTransformer.jl/tree/5e5e1e4a049d5d44514a463c82ca235ec8cd81b0/docs/src/introduction.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Introduction</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Introduction-1" href="#Introduction-1">Introduction</a></h1><p>This module is based on the design procedure described in <a href="http://www.ti.com/download/trng/docs/seminar/Topic4LD.pdf">Designing Planar Magnetics</a>.</p><p>Load the module.</p><div><pre><code class="language-julia">using PlanerTransformer</code></pre></div><p>Define the PCB.</p><div><pre><code class="language-julia">trace_edge_gap = 0.16e-3
trace_trace_gap = 0.13e-3
outer_copper_thickness = copper_weight_to_meters(1.0)
inner_copper_thickness = copper_weight_to_meters(1.0)
number_of_layers = 4
pcb = PCB_Specification(trace_edge_gap,
                        trace_trace_gap,
                        outer_copper_thickness,
                        inner_copper_thickness,
                        number_of_layers)</code></pre><pre><code class="language-none">PlanerTransformer.PCB_Specification(0.00016, 0.00013, 0.00048, 0.00048, 4, 1.68e-8, 0.003862)</code></pre></div><p>Define core geometry and type of ferrite, or use data from <code>core_geometry_dict</code> and <code>ferrite_dict</code>.</p><div><pre><code class="language-julia">e_core = core_geometry_dict[&quot;e14&quot;]</code></pre><pre><code class="language-none">PlanerTransformer.CoreGeometry(&quot;e14&quot;, 0.004, 0.0015, 0.005, 3.0e-7, 1.45e-5, 0.0167, 0.0006)</code></pre></div><div><pre><code class="language-julia">plate = core_geometry_dict[&quot;plt14&quot;]</code></pre><pre><code class="language-none">PlanerTransformer.CoreGeometry(&quot;plt14&quot;, 0.0, 0.0, 0.0, 2.4e-7, 1.45e-5, 0.0167, 0.0005)</code></pre></div><div><pre><code class="language-julia">material = ferrite_dict[&quot;3f4&quot;]</code></pre><pre><code class="language-none">PlanerTransformer.FerriteProperties(&quot;3f4&quot;, 1.0e6, 2.0e6, 25.0, 100.0, PlanerTransformer.BHloop(60.0, 0.4, 0.16), PlanerTransformer.BHloop(50.0, 0.345, 0.14), PlanerTransformer.SpecificPowerLossData((25000.0, 100000.0, 200000.0, 400000.0, 1.0e6, 2.0e6, 3.0e6), ((3.1281387742109854, 7.676494605322182), (3.1875558695275217, 8.482370835247128), (2.9036745939932196, 8.506306231155797), (2.7083151100806866, 8.54300326442518), (2.7621709072598892, 9.338977657397393), (2.2817081225100986, 9.45686280097184), (2.089976736699681, 9.613698825453952))))</code></pre></div><p>Define the windings.  In this case the primary will be 3 turns, 3 on each outer layer, both layers in parallel.  The secondary will be 4 turns, 2 turns on each inner layer, both layers in series.</p><div><pre><code class="language-julia">layer1 = winding_layer(pcb,true,e_core,3)
layer2 = winding_layer(pcb,false,e_core,2)
layer3 = winding_layer(pcb,false,e_core,2)
layer4 = winding_layer(pcb,true,e_core,3)
primary = Winding(pcb,[layer1,layer4],false)
secondary = Winding(pcb,[layer2,layer3],true)</code></pre><pre><code class="language-none">PlanerTransformer.Winding(PlanerTransformer.PCB_Specification(0.00016, 0.00013, 0.00048, 0.00048, 4, 1.68e-8, 0.003862), PlanerTransformer.WindingLayer[PlanerTransformer.WindingLayer(0.001775, 0.0539823, 0.00048, 2), PlanerTransformer.WindingLayer(0.001775, 0.0539823, 0.00048, 2)], true, 4)</code></pre></div><p>Define the magnetics.  Effective areas for cores in the magnetic circuit must match.</p><div><pre><code class="language-julia">magnetics = Magnetics(material, [e_core, plate])</code></pre><pre><code class="language-none">PlanerTransformer.Magnetics(PlanerTransformer.FerriteProperties(&quot;3f4&quot;, 1.0e6, 2.0e6, 25.0, 100.0, PlanerTransformer.BHloop(60.0, 0.4, 0.16), PlanerTransformer.BHloop(50.0, 0.345, 0.14), PlanerTransformer.SpecificPowerLossData((25000.0, 100000.0, 200000.0, 400000.0, 1.0e6, 2.0e6, 3.0e6), ((3.1281387742109854, 7.676494605322182), (3.1875558695275217, 8.482370835247128), (2.9036745939932196, 8.506306231155797), (2.7083151100806866, 8.54300326442518), (2.7621709072598892, 9.338977657397393), (2.2817081225100986, 9.45686280097184), (2.089976736699681, 9.613698825453952)))), PlanerTransformer.CoreGeometry[PlanerTransformer.CoreGeometry(&quot;e14&quot;, 0.004, 0.0015, 0.005, 3.0e-7, 1.45e-5, 0.0167, 0.0006), PlanerTransformer.CoreGeometry(&quot;plt14&quot;, 0.0, 0.0, 0.0, 2.4e-7, 1.45e-5, 0.0167, 0.0005)], 5.399999999999999e-7, 1.45e-5, 0.0334, 0.0010999999999999998)</code></pre></div><p>Define the transformer.  The first element in the winding array should be the input to the transformer.</p><div><pre><code class="language-julia">transformer = Transformer(magnetics, [primary, secondary])</code></pre><pre><code class="language-none">PlanerTransformer.Transformer(PlanerTransformer.Magnetics(PlanerTransformer.FerriteProperties(&quot;3f4&quot;, 1.0e6, 2.0e6, 25.0, 100.0, PlanerTransformer.BHloop(60.0, 0.4, 0.16), PlanerTransformer.BHloop(50.0, 0.345, 0.14), PlanerTransformer.SpecificPowerLossData((25000.0, 100000.0, 200000.0, 400000.0, 1.0e6, 2.0e6, 3.0e6), ((3.1281387742109854, 7.676494605322182), (3.1875558695275217, 8.482370835247128), (2.9036745939932196, 8.506306231155797), (2.7083151100806866, 8.54300326442518), (2.7621709072598892, 9.338977657397393), (2.2817081225100986, 9.45686280097184), (2.089976736699681, 9.613698825453952)))), PlanerTransformer.CoreGeometry[PlanerTransformer.CoreGeometry(&quot;e14&quot;, 0.004, 0.0015, 0.005, 3.0e-7, 1.45e-5, 0.0167, 0.0006), PlanerTransformer.CoreGeometry(&quot;plt14&quot;, 0.0, 0.0, 0.0, 2.4e-7, 1.45e-5, 0.0167, 0.0005)], 5.399999999999999e-7, 1.45e-5, 0.0334, 0.0010999999999999998), PlanerTransformer.Winding[PlanerTransformer.Winding(PlanerTransformer.PCB_Specification(0.00016, 0.00013, 0.00048, 0.00048, 4, 1.68e-8, 0.003862), PlanerTransformer.WindingLayer[PlanerTransformer.WindingLayer(0.00114, 0.0759734, 0.00048, 3), PlanerTransformer.WindingLayer(0.00114, 0.0759734, 0.00048, 3)], false, 3), PlanerTransformer.Winding(PlanerTransformer.PCB_Specification(0.00016, 0.00013, 0.00048, 0.00048, 4, 1.68e-8, 0.003862), PlanerTransformer.WindingLayer[PlanerTransformer.WindingLayer(0.001775, 0.0539823, 0.00048, 2), PlanerTransformer.WindingLayer(0.001775, 0.0539823, 0.00048, 2)], true, 4)])</code></pre></div><p>Now that the transformer is defined, we can estimate some circuit parameters. First pick an operating frequency, and a maximum specific power loss for the core.</p><div><pre><code class="language-julia">frequency = 1e6 # Hz
spl_max = 450e3 # W/m^3</code></pre><pre><code class="language-none">450000.0</code></pre></div><p>Corresponding maximum peak to peak flux density.</p><div><pre><code class="language-julia">flux_density_max_pp = flux_density(transformer, spl_max, frequency) # Tesla</code></pre><pre><code class="language-none">0.04630494912910643</code></pre></div><p>Maximum volt seconds on each winding.</p><div><pre><code class="language-julia">volt_seconds_max = volt_seconds(transformer, flux_density_max_pp)</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 2.01427e-6
 2.68569e-6</code></pre></div><p>Power Dissipation with 0.5Vpp 50% duty cycle square wave on the primary and 1App load on the secondary.</p><div><pre><code class="language-julia">primary_voltage_pp = 0.5
output_current_pp = 1.0
tpd =TransformerPowerDissipation(transformer,
              [primary_voltage_pp, output_current_pp], frequency)
total_power = tpd.total_power # W</code></pre><pre><code class="language-none">0.0063153285485982764</code></pre></div><p>Parameters for a LTspice transformer model can also be computed.</p><div><pre><code class="language-julia">r1_r2 = winding_resistance(transformer)</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 0.00152659
 0.00278662</code></pre></div><div><pre><code class="language-julia">l1 = chan_inductor(transformer)</code></pre><pre><code class="language-none">Hc=50.0, Bs=0.345, Br=0.14, A=1.45e-5, Lm=0.0334, Lg=0.0, N=1.0</code></pre></div><div><pre><code class="language-julia">r3 = equivalent_parallel_resistance(transformer, primary_voltage_pp, frequency)</code></pre><pre><code class="language-none">15.756439720643668</code></pre></div><div><pre><code class="language-julia">n1_n2 = turns(transformer)</code></pre><pre><code class="language-none">2-element Array{Int64,1}:
 3
 4</code></pre></div><p><img src="../LTspice transformer model.jpg" alt="LTspice transformer model"/></p><footer><hr/><a class="previous" href="../install/"><span class="direction">Previous</span><span class="title">Installation</span></a><a class="next" href="../design_api/"><span class="direction">Next</span><span class="title">Design API</span></a></footer></article></body></html>
